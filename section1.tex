\section{First section}

\subsection{First subsection}
\begin{wrapfigure}{r}{3cm} % Second parameter specify the width of the wrapping around the figure
	\begin{center}
		\includegraphics[height=2cm]{example}
	\end{center}
	\caption{Photo example}
	\label{figure 1}
\end{wrapfigure}

\lipsum[1-2]

Look at the figure \ref{figure 1}. % There's no new line!!!
\lipsum[3]

\begin{wrapfigure}{l}{3cm}
	\begin{center}
		\includegraphics[height=2cm]{example}
	\end{center}
	\caption{Photo example}
	\label{figure 2}
\end{wrapfigure}

Now look at figure \ref{figure 2}.
\lipsum[4-10]

\subsection{Second subsection}
\lipsum[2-3]
\xmlcode{my_xml_code.xml}{XML code example}
\lipsum[4]

\subsection{Third subsection}
\lipsum[5-7]
